/*  
	Author Details
	==============
	Author: Ranjith Pandi

	Author URL: http://ranjithpandi.com

	Attribution is must on every page, where this work is used.

	For Attribution removal request. please consider contacting us through http://ranjithpandi.com/#contact
*/

(function(e){var t={color:"#FF0000",lineWidth:5};var n={init:function(n,r){var i=this;i.$ele=n;i.options=e.extend({},t,r);i.initializeToolbar();i.initPaint()},initializeToolbar:function(){var t=this;var n=t.options.color;var r=t.options.lineWidth;var i=[];i.push('<div class="toolbar-item"><div class="tools" data-type="paint">Marker</div><div class="tools" data-type="eraser">Eraser</div>');i.push('<div>Line Width <input type="range" id="brushWidth" name="points" value="'+r+'" min="1" max="15"></div>');i.push('<div>Color <input type="color" id="brushColor" name="brushColor" value="'+n+'"></div>');i.push("</div>");t.$ele.before(i.join(""));e(".toolbar-item div.tools").on("click",function(){t.setTools(e(this))});e("#brushWidth").on("change",function(){t.setWidth(e(this).val())});e("#brushColor").on("change",function(){t.setColor(e(this).val())})},setColor:function(e){var t=this;t.$ele.css("cursor","url(images/brush.png), auto");t.ctx.globalCompositeOperation="source-over";t.options.color=e;t.ctx.lineWidth=t.options.lineWidth;t.ctx.strokeStyle=e},setWidth:function(e){var t=this;t.$ele.css("cursor","url(images/brush.png), auto");t.ctx.globalCompositeOperation="source-over";t.ctx.strokeStyle=t.options.color;t.options.lineWidth=e;t.ctx.lineWidth=e},setTools:function(e){var t=this;var n=e.data("type");if(n=="eraser"){t.$ele.css("cursor","url(images/eraser.png), auto");t.ctx.globalCompositeOperation="destination-out";t.ctx.strokeStyle="rgba(0,0,0,1)"}else{t.$ele.css("cursor","url(images/brush.png), auto");t.ctx.globalCompositeOperation="source-over";t.ctx.strokeStyle=t.options.color;t.ctx.lineWidth=t.options.lineWidth}},initPaint:function(){var e=this;e.canvas=e.$ele[0];e.position={x:e.$ele.offset().left,y:e.$ele.offset().top};e.ctx=e.canvas.getContext("2d");e.ctx.strokeStyle=e.options.color;e.ctx.lineWidth=e.options.lineWidth;e.drawing=false;e.initEvents()},initEvents:function(){var e=this;e.$ele.on("mousedown",function(){e.startDraw(event)}).on("mousemove",function(){e.draw(event)}).on("mouseup mouseout",function(){e.stopDraw()})},startDraw:function(e){var t=this;var n=e.pageX-t.position.x;var r=e.pageY-t.position.y;t.ctx.beginPath();t.ctx.moveTo(n,r);t.drawing=true},draw:function(e){var t=this;if(t.drawing){var n=e.pageX-t.position.x;var r=e.pageY-t.position.y;t.ctx.lineTo(n,r);t.ctx.stroke()}},stopDraw:function(){var e=this;if(e.drawing){e.drawing=false}}};e.fn.paint=function(t){return this.each(function(){var r=Object.create(n);r.init(e(this),t)})}})(jQuery)